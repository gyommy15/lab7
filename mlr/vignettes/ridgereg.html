<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Josh Hyungyum Kim" />

<meta name="date" content="2017-10-14" />

<title>ridgereg</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">ridgereg</h1>
<h4 class="author"><em>Josh Hyungyum Kim</em></h4>
<h4 class="date"><em>2017-10-14</em></h4>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mlbench)
<span class="kw">library</span>(caret)
<span class="co">#&gt; Loading required package: lattice</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="kw">require</span>(mlr)
<span class="co">#&gt; Loading required package: mlr</span>
<span class="co">#&gt; Loading required package: ParamHelpers</span>
<span class="co">#&gt; Warning: replacing previous import 'BBmisc::isFALSE' by</span>
<span class="co">#&gt; 'backports::isFALSE' when loading 'mlr'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'mlr'</span>
<span class="co">#&gt; The following object is masked from 'package:caret':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     train</span>
<span class="kw">library</span>(methods)
<span class="kw">data</span>(<span class="st">&quot;BostonHousing&quot;</span>)</code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In this vignette, it will be shown how to do a simple prediction problem using ridgereg() function in the package “mlr” with the data <em>BostonHousing</em> found in the mlbench package. The dataset consists of 506 observations of 14 variables. The median value of house price in $1000s, denoted by MEDV, is the outcome or the target variable in our model. Below is a brief description of each feature and the outcome in our dataset:</p>
<ol style="list-style-type: decimal">
<li>CRIM --- per capita crime rate by town</li>
<li>ZN --- proportion of residential land zoned for lots over 25,000 sq.ft</li>
<li>INDUS --- proportion of non-retail business acres per town</li>
<li>CHAS --- Charles River dummy variable (1 if tract bounds river; else 0)</li>
<li>NOX --- nitric oxides concentration (parts per 10 million)</li>
<li>RM --- average number of rooms per dwelling</li>
<li>AGE --- proportion of owner-occupied units built prior to 1940</li>
<li>DIS --- weighted distances to five Boston employment centres</li>
<li>RAD --- index of accessibility to radial highways</li>
<li>TAX --- full-value property-tax rate per $10,000</li>
<li>PTRATIO --- pupil-teacher ratio by town</li>
<li>B --- 1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town</li>
<li>LSTAT --- % lower status of the population</li>
<li>MEDV --- Median value of owner-occupied homes in $1000’s</li>
</ol>
<p>First 6 rows of the dataset are shown below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(BostonHousing)
<span class="co">#&gt;      crim zn indus chas   nox    rm  age    dis rad tax ptratio      b</span>
<span class="co">#&gt; 1 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3 396.90</span>
<span class="co">#&gt; 2 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8 396.90</span>
<span class="co">#&gt; 3 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8 392.83</span>
<span class="co">#&gt; 4 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7 394.63</span>
<span class="co">#&gt; 5 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7 396.90</span>
<span class="co">#&gt; 6 0.02985  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7 394.12</span>
<span class="co">#&gt;   lstat medv</span>
<span class="co">#&gt; 1  4.98 24.0</span>
<span class="co">#&gt; 2  9.14 21.6</span>
<span class="co">#&gt; 3  4.03 34.7</span>
<span class="co">#&gt; 4  2.94 33.4</span>
<span class="co">#&gt; 5  5.33 36.2</span>
<span class="co">#&gt; 6  5.21 28.7</span></code></pre></div>
<div id="divide-the-bostonhousing-data-into-a-test-and-training-dataset" class="section level3">
<h3>1. Divide the BostonHousing data into a test and training dataset</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)
inTrain &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(BostonHousing$medv, <span class="dt">p =</span> .<span class="dv">7</span>, <span class="dt">list =</span> <span class="ot">FALSE</span>)
training &lt;-<span class="st"> </span>BostonHousing[ inTrain,]
testing  &lt;-<span class="st"> </span>BostonHousing[-inTrain,]

<span class="co">#For the 10-fold cross-validation</span>
ctrl &lt;-<span class="st"> </span>caret::<span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>,
  <span class="dt">number =</span> <span class="dv">10</span>, <span class="co"># k=10</span>
  <span class="dt">repeats =</span> <span class="dv">10</span>) <span class="co"># repeat 10 times</span>

BostonHousing$chas &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(BostonHousing$chas) -<span class="st"> </span><span class="dv">1</span>
BostonHousing &lt;-<span class="st"> </span><span class="kw">scale</span>(BostonHousing)</code></pre></div>
</div>
<div id="fit-a-linear-regression-model." class="section level3">
<h3>2-1. Fit a linear regression model.</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)
lm &lt;-<span class="st"> </span>caret::<span class="kw">train</span>(medv ~<span class="st"> </span>., 
            <span class="dt">data =</span> training,
            <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,
            <span class="dt">trControl =</span> ctrl)
lm
<span class="co">#&gt; Linear Regression </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 356 samples</span>
<span class="co">#&gt;  13 predictor</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; No pre-processing</span>
<span class="co">#&gt; Resampling: Cross-Validated (10 fold, repeated 10 times) </span>
<span class="co">#&gt; Summary of sample sizes: 320, 320, 320, 320, 320, 321, ... </span>
<span class="co">#&gt; Resampling results:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   RMSE      Rsquared   MAE     </span>
<span class="co">#&gt;   5.012331  0.7140371  3.557906</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Tuning parameter 'intercept' was held constant at a value of TRUE</span></code></pre></div>
</div>
<div id="fit-a-linear-regression-model-with-forward-selection." class="section level3">
<h3>2-2. Fit a linear regression model with forward selection.</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)
lflmGrid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">nvmax=</span><span class="dv">1</span>:(<span class="kw">ncol</span>(training)-<span class="dv">1</span>))
lflm &lt;-<span class="st"> </span>caret::<span class="kw">train</span>(medv ~<span class="st"> </span>., 
              <span class="dt">data =</span> training,
              <span class="dt">method =</span> <span class="st">&quot;leapForward&quot;</span>,
              <span class="dt">trControl =</span> ctrl,
              <span class="dt">tuneGrid =</span> lflmGrid)

lflm
<span class="co">#&gt; Linear Regression with Forward Selection </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 356 samples</span>
<span class="co">#&gt;  13 predictor</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; No pre-processing</span>
<span class="co">#&gt; Resampling: Cross-Validated (10 fold, repeated 10 times) </span>
<span class="co">#&gt; Summary of sample sizes: 320, 320, 320, 320, 320, 321, ... </span>
<span class="co">#&gt; Resampling results across tuning parameters:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   nvmax  RMSE      Rsquared   MAE     </span>
<span class="co">#&gt;    1     6.374107  0.5407978  4.699421</span>
<span class="co">#&gt;    2     5.769672  0.6248276  4.201883</span>
<span class="co">#&gt;    3     5.369359  0.6699434  3.817078</span>
<span class="co">#&gt;    4     5.428010  0.6624405  3.818625</span>
<span class="co">#&gt;    5     5.190781  0.6897693  3.695211</span>
<span class="co">#&gt;    6     5.156619  0.6940444  3.632217</span>
<span class="co">#&gt;    7     5.150199  0.6955314  3.628006</span>
<span class="co">#&gt;    8     5.108626  0.7010187  3.620160</span>
<span class="co">#&gt;    9     5.086869  0.7040622  3.607101</span>
<span class="co">#&gt;   10     5.052085  0.7085892  3.578356</span>
<span class="co">#&gt;   11     4.979667  0.7174640  3.538078</span>
<span class="co">#&gt;   12     5.006158  0.7147176  3.552701</span>
<span class="co">#&gt;   13     5.012331  0.7140371  3.557906</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; RMSE was used to select the optimal model using  the smallest value.</span>
<span class="co">#&gt; The final value used for the model was nvmax = 11.</span>

<span class="kw">summary</span>(lflm)
<span class="co">#&gt; Subset selection object</span>
<span class="co">#&gt; 13 Variables  (and intercept)</span>
<span class="co">#&gt;         Forced in Forced out</span>
<span class="co">#&gt; crim        FALSE      FALSE</span>
<span class="co">#&gt; zn          FALSE      FALSE</span>
<span class="co">#&gt; indus       FALSE      FALSE</span>
<span class="co">#&gt; chas1       FALSE      FALSE</span>
<span class="co">#&gt; nox         FALSE      FALSE</span>
<span class="co">#&gt; rm          FALSE      FALSE</span>
<span class="co">#&gt; age         FALSE      FALSE</span>
<span class="co">#&gt; dis         FALSE      FALSE</span>
<span class="co">#&gt; rad         FALSE      FALSE</span>
<span class="co">#&gt; tax         FALSE      FALSE</span>
<span class="co">#&gt; ptratio     FALSE      FALSE</span>
<span class="co">#&gt; b           FALSE      FALSE</span>
<span class="co">#&gt; lstat       FALSE      FALSE</span>
<span class="co">#&gt; 1 subsets of each size up to 11</span>
<span class="co">#&gt; Selection Algorithm: forward</span>
<span class="co">#&gt;           crim zn  indus chas1 nox rm  age dis rad tax ptratio b   lstat</span>
<span class="co">#&gt; 1  ( 1 )  &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;     &quot; &quot; &quot;*&quot;  </span>
<span class="co">#&gt; 2  ( 1 )  &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;     &quot; &quot; &quot;*&quot;  </span>
<span class="co">#&gt; 3  ( 1 )  &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot;     &quot; &quot; &quot;*&quot;  </span>
<span class="co">#&gt; 4  ( 1 )  &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot;     &quot; &quot; &quot;*&quot;  </span>
<span class="co">#&gt; 5  ( 1 )  &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot;     &quot; &quot; &quot;*&quot;  </span>
<span class="co">#&gt; 6  ( 1 )  &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot;     &quot;*&quot; &quot;*&quot;  </span>
<span class="co">#&gt; 7  ( 1 )  &quot; &quot;  &quot; &quot; &quot; &quot;   &quot; &quot;   &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot;     &quot;*&quot; &quot;*&quot;  </span>
<span class="co">#&gt; 8  ( 1 )  &quot; &quot;  &quot; &quot; &quot; &quot;   &quot;*&quot;   &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot;     &quot;*&quot; &quot;*&quot;  </span>
<span class="co">#&gt; 9  ( 1 )  &quot; &quot;  &quot; &quot; &quot; &quot;   &quot;*&quot;   &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;     &quot;*&quot; &quot;*&quot;  </span>
<span class="co">#&gt; 10  ( 1 ) &quot; &quot;  &quot;*&quot; &quot; &quot;   &quot;*&quot;   &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;     &quot;*&quot; &quot;*&quot;  </span>
<span class="co">#&gt; 11  ( 1 ) &quot;*&quot;  &quot;*&quot; &quot; &quot;   &quot;*&quot;   &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;     &quot;*&quot; &quot;*&quot;</span></code></pre></div>
</div>
<div id="evaluate-the-performance-of-this-model-on-the-training-dataset." class="section level3">
<h3>3. Evaluate the performance of this model on the training dataset.</h3>
<p>Based on the RMSE results above, regression model with 11 factors(excluding indus, age) is slightly better than with all 13 factors model. Though the difference is very small, model with 10 factors is simpler. For a detailed evaluation, residual vs fitted plot should be drawn.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(<span class="kw">predict</span>(lflm), <span class="kw">scale</span>(<span class="kw">resid</span>(lflm))))

plot1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(p_data, <span class="kw">aes</span>(<span class="dt">x =</span> p_data[,<span class="dv">1</span>], <span class="dt">y =</span> p_data[,<span class="dv">2</span>])) +<span class="st"> </span><span class="kw">geom_point</span>() +
<span class="st">          </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Fitted&quot;</span>) +
<span class="st">          </span><span class="kw">ylab</span>(<span class="st">&quot;Residuals&quot;</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Resid vs Fitted with 10 factors&quot;</span>) +
<span class="st">          </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))

<span class="kw">plot</span>(plot1)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Above plot implies a clustering tendency of data and further investigation is needed to select a better model to fit this data.</p>
</div>
<div id="fit-a-ridge-regression-model-using-ridgereg-function-in-mlr-package." class="section level3">
<h3>4. Fit a ridge regression model using ridgereg() function in mlr package.</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#To use rigdereg() function</span>
rglm &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;Classification&quot;</span>, <span class="st">&quot;Regression&quot;</span>),
            <span class="dt">library=</span><span class="st">&quot;mlr&quot;</span>,
            <span class="dt">loop=</span><span class="ot">NULL</span>,
            <span class="dt">prob=</span><span class="ot">NULL</span>)

<span class="co">#Parameter setting</span>
rglm$label&lt;-<span class="st">&quot;Ridge regression by mlr package&quot;</span>

rglm$parameters &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">parameter =</span> <span class="st">&quot;lambda&quot;</span>,
                  <span class="dt">class =</span> <span class="st">&quot;numeric&quot;</span>,
                  <span class="dt">label =</span> <span class="st">&quot;lambda&quot;</span>)

rglm$fit &lt;-<span class="st"> </span>function(x, y, lambda, param, lev, last, classProbs, ...) { 
  dat &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(x)
  
  respvector &lt;-<span class="st"> </span><span class="ot">NULL</span>
  respname &lt;-<span class="st"> </span><span class="ot">NULL</span>
  respnum &lt;-<span class="st"> </span><span class="ot">NULL</span>

  for(i in <span class="dv">1</span>:<span class="kw">ncol</span>(x)){
    if(<span class="kw">identical</span>(y,dat[,i])){
    respvector &lt;-<span class="st"> </span>dat[,i]
    respname &lt;-<span class="st"> </span><span class="kw">names</span>(x)[i]
    respnum &lt;-<span class="st"> </span>i
    }
  }

  formula &lt;-<span class="st"> </span><span class="kw">paste</span>(respname,<span class="st">&quot;~&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)

  if(<span class="kw">ncol</span>(x) &gt;<span class="st"> </span><span class="dv">1</span>){
    for(i in <span class="dv">1</span>:<span class="kw">ncol</span>(x)-<span class="dv">1</span>){
            formula &lt;-<span class="st"> </span><span class="kw">paste</span>(formula, <span class="st">&quot;+&quot;</span>, <span class="kw">names</span>(dat)[i], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)
    }
  }

  formula &lt;-<span class="st"> </span><span class="kw">as.formula</span>(formula)
  
  ridgereg$<span class="kw">new</span>(<span class="dt">formula =</span> formula, <span class="dt">data=</span>dat,<span class="dt">lambda=</span> param$lambda)
 }
 
rglm$predict &lt;-<span class="st"> </span>function(modelFit, newdata, <span class="dt">preProc=</span><span class="ot">NULL</span>, <span class="dt">submodels =</span> <span class="ot">NULL</span>){
  if (!<span class="kw">is.data.frame</span>(newdata)) 
    newdata &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(newdata)
  modelFit$<span class="kw">predict</span>(newdata)
}

rglm$sort  &lt;-<span class="st"> </span>function(x) x[<span class="kw">order</span>(-x$lambda),]


rglm$grid &lt;-<span class="st"> </span>function(x, y, <span class="dt">len=</span><span class="ot">NULL</span>, <span class="dt">search=</span><span class="st">&quot;grid&quot;</span>){
  <span class="kw">data.frame</span>(<span class="dt">lambda=</span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">5</span>, <span class="dt">by=</span><span class="dv">1</span>))
}

<span class="kw">set.seed</span>(<span class="dv">12345</span>)
rglm_fit &lt;-<span class="st"> </span>caret::<span class="kw">train</span>(<span class="dt">x =</span> training,
                  <span class="dt">y =</span> training$medv,
                  <span class="dt">method =</span> rglm,
                  <span class="dt">trControl =</span> ctrl)

rglm_fit
<span class="co">#&gt; Ridge regression by mlr package </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 356 samples</span>
<span class="co">#&gt;  14 predictor</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; No pre-processing</span>
<span class="co">#&gt; Resampling: Cross-Validated (10 fold, repeated 10 times) </span>
<span class="co">#&gt; Summary of sample sizes: 320, 320, 320, 320, 320, 321, ... </span>
<span class="co">#&gt; Resampling results across tuning parameters:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   lambda  RMSE      Rsquared   MAE     </span>
<span class="co">#&gt;   0       5.029208  0.7121530  3.600433</span>
<span class="co">#&gt;   1       5.024726  0.7123850  3.580974</span>
<span class="co">#&gt;   2       5.021930  0.7125608  3.563819</span>
<span class="co">#&gt;   3       5.020684  0.7126908  3.548537</span>
<span class="co">#&gt;   4       5.020880  0.7127830  3.534499</span>
<span class="co">#&gt;   5       5.022425  0.7128440  3.521421</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; RMSE was used to select the optimal model using  the smallest value.</span>
<span class="co">#&gt; The final value used for the model was lambda = 3.</span></code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
